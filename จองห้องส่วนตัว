// 1. นำ URL ที่ได้จากขั้นตอนที่แล้วมาวางตรงนี้
const scriptURL = 'AKfycbzN57vVT-OIGDRVDlXxWqOA5JAkMj7T5Q1wZjHNhDk';

function handleFormSubmit(formObject) {
    event.preventDefault();
    const btn = document.getElementById('submitBtn');
    const msgDiv = document.getElementById('message');
    
    btn.disabled = true;
    btn.innerHTML = '<span class="spinner-border spinner-border-sm"></span> กำลังบันทึก...';
    msgDiv.className = "mt-3 text-center text-primary";
    msgDiv.innerHTML = "รอสักครู่...";

    // 2. ปรับโครงสร้างข้อมูลที่จะส่ง
    const formData = {
        name: formObject.name.value,
        room: formObject.room.value,
        bookingDate: formObject.bookingDate.value,
        startTime: formObject.startTime.value,
        endTime: formObject.endTime.value
    };

    // 3. ใช้ fetch แทน google.script.run
    fetch(scriptURL, {
        method: 'POST',
        body: JSON.stringify(formData)
    })
    .then(response => {
        msgDiv.className = "mt-3 text-center text-success";
        msgDiv.innerHTML = "✅ บันทึกข้อมูลการจองสำเร็จ!";
        document.getElementById('bookingForm').reset();
        document.getElementById('bookingDate').valueAsDate = new Date();
        btn.disabled = false;
        btn.innerText = "ยืนยันการจอง";
    })
    .catch(error => {
        msgDiv.className = "mt-3 text-center text-danger";
        msgDiv.innerHTML = "❌ เกิดข้อผิดพลาด: " + error.message;
        btn.disabled = false;
        btn.innerText = "ลองอีกครั้ง";
    });
}
